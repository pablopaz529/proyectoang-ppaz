<div class="container mt-4">
  
  <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap">
    <h2 class="mb-3 mb-md-0">Catálogo de Cine</h2>
    
    <div class="btn-group shadow-lg mt-4 mb-2" role="group">
      <button type="button" class="btn" 
              [class.btn-dark]="filtroActual === 'popular'"
              [class.btn-outline-dark]="filtroActual !== 'popular'"
              (click)="cargarDatos('popular')">
        Populares
      </button>

      <button type="button" class="btn" 
              [class.btn-dark]="filtroActual === 'now_playing'"
              [class.btn-outline-dark]="filtroActual !== 'now_playing'"
              (click)="cargarDatos('now_playing')">
        En Cartelera
      </button>

      <button type="button" class="btn" 
              [class.btn-dark]="filtroActual === 'upcoming'"
              [class.btn-outline-dark]="filtroActual !== 'upcoming'"
              (click)="cargarDatos('upcoming')">
        Próximamente
      </button>
      
      <button type="button" class="btn" 
              [class.btn-dark]="filtroActual === 'top_rated'"
              [class.btn-outline-dark]="filtroActual !== 'top_rated'"
              (click)="cargarDatos('top_rated')">
        Top Valoradas
      </button>
    </div>
  </div>

  <div class="row mb-4 g-3">
    
    <div class="col-12 col-md-6">
      <div class="input-group shadow-sm">
        <span class="input-group-text bg-white border-end-0">
          <i class="bi bi-search"></i>
        </span>
        <input type="text" 
               class="form-control border-start-0" 
               placeholder="Buscar película por título..." 
               (input)="buscar($event)">
      </div>
    </div>

    <div class="col-12 col-md-6 d-flex sh justify-content-md-end gap-2">
      <button class="btn btn-outline-secondary d-flex align-items-center" (click)="ordenar('titulo')">
        <i class="bi bi-sort-alpha-down me-2"></i> A-Z
      </button>
      <button class="btn btn-outline-secondary d-flex align-items-center" (click)="ordenar('puntuacion')">
        <i class="bi bi-star-fill text-warning me-2"></i> Mejor Nota
      </button>
    </div>
  </div>
  <div class="row row-cols-2 row-cols-md-4 row-cols-lg-5 g-4">
    
    @for (peli of peliculas; track peli.id) {
      <div class="col">
        <div class="card h-100 shadow border-0">
          
          @if (peli.poster_path) {
            <img [src]="'https://image.tmdb.org/t/p/w500' + peli.poster_path" 
                 class="card-img-top rounded" 
                 [alt]="peli.title"
                 [routerLink]= "['/pelicula', peli.id]">
          } @else {
             <div class="bg-secondary text-white d-flex align-items-center justify-content-center rounded" style="height: 300px;">
               Sin Imagen
             </div>
          }

          <div class="card-body p-2">
            <h6 class="card-title text-truncate fw-bold mb-1">{{ peli.title }}</h6>
            <div class="d-flex justify-content-between align-items-center small text-muted">
              <span>{{ peli.release_date | date:'yyyy' }}</span>
              <span class="badge bg-warning text-dark">
                ★ {{ peli.vote_average | number:'1.1-1' }}
              </span>
            </div>
          </div>

        </div>
      </div>
    } 
    
    @empty {
      <div class="col-12 text-center py-5">
        @if (textoBusqueda) {
          <i class="bi bi-search fs-1 text-muted"></i>
          <p class="mt-2 text-muted">No se encontraron películas con ese nombre.</p>
        } @else {
          <div class="spinner-border text-primary" role="status"></div>
          <p class="mt-2 text-muted">Cargando películas...</p>
        }
      </div>
    }

  </div>
</div>